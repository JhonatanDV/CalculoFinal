import streamlit as st
from assets.enhanced_study_plans import installation_documentation, faq_section, additional_learning_resources

def show():
    """Display comprehensive documentation for installation and usage."""
    st.title("üìñ Documentaci√≥n Completa")
    st.markdown("Gu√≠a completa para instalar, usar y aprovechar al m√°ximo tu Calculadora Matem√°tica")
    
    # Navigation tabs
    tab1, tab2, tab3, tab4 = st.tabs([
        "üîß Instalaci√≥n", 
        "üöÄ Gu√≠a de Uso", 
        "‚ùì FAQ", 
        "üìö Recursos Adicionales"
    ])
    
    with tab1:
        show_installation_guide()
    
    with tab2:
        show_usage_guide()
    
    with tab3:
        show_faq()
    
    with tab4:
        show_additional_resources()

def show_installation_guide():
    """Display installation instructions."""
    st.markdown("# üîß Gu√≠a de Instalaci√≥n")
    st.markdown("Sigue estos pasos para tener la calculadora funcionando en tu computadora")
    
    for section in installation_documentation["sections"]:
        if section["title"] == "üîß Instalaci√≥n":
            for step_info in section["content"]:
                with st.expander(f"**{step_info['step']}**: {step_info['description']}", expanded=False):
                    st.markdown(f"### {step_info['description']}")
                    
                    for detail in step_info["details"]:
                        st.markdown(f"‚Ä¢ {detail}")
                    
                    # Special handling for different steps
                    if "Python" in step_info["step"]:
                        st.code("""
# Verificar instalaci√≥n de Python
python --version

# Deber√≠a mostrar algo como: Python 3.11.x
                        """, language="bash")
                    
                    elif "Dependencias" in step_info["step"]:
                        st.code("""
# Opci√≥n 1: Usar requirements.txt
pip install -r requirements.txt

# Opci√≥n 2: Instalar manualmente
pip install streamlit sympy matplotlib plotly numpy
                        """, language="bash")
                        
                        # Show requirements.txt content
                        st.markdown("**Contenido del archivo requirements.txt:**")
                        st.code("""
streamlit>=1.28.0
sympy==1.11.1
matplotlib>=3.7.0
plotly>=5.15.0
numpy>=1.24.0
                        """, language="text")
                    
                    elif "Ejecutar" in step_info["step"]:
                        st.code("""
# Ejecutar la aplicaci√≥n
streamlit run app.py

# La aplicaci√≥n estar√° disponible en:
# http://localhost:8501
                        """, language="bash")
                        
                        st.success("üéâ ¬°Una vez que veas 'You can now view your Streamlit app in your browser', estar√°s listo!")

def show_usage_guide():
    """Display usage instructions."""
    st.markdown("# üöÄ Gu√≠a de Uso R√°pido")
    st.markdown("Aprende a usar todas las funciones de la calculadora")
    
    # Quick start
    st.markdown("## ‚ö° Inicio R√°pido")
    st.markdown("""
    1. üåê **Abre la aplicaci√≥n** en tu navegador (normalmente http://localhost:8501)
    2. üßÆ **Selecciona una calculadora** del men√∫ lateral
    3. ‚úèÔ∏è **Ingresa tu funci√≥n** usando sintaxis de Python
    4. üìä **Obt√©n resultados** con gr√°ficas y explicaciones paso a paso
    """)
    
    # Feature guides
    for section in installation_documentation["sections"]:
        if section["title"] == "üöÄ Gu√≠a de Uso R√°pido":
            for feature_info in section["content"]:
                with st.expander(f"üì± **{feature_info['feature']}**", expanded=False):
                    st.markdown(f"### C√≥mo usar {feature_info['feature']}")
                    
                    for i, step in enumerate(feature_info["steps"], 1):
                        st.markdown(f"**{step}**")
                    
                    # Add visual examples
                    if "Integrales" in feature_info["feature"]:
                        st.markdown("**Ejemplos de funciones:**")
                        st.code("""
# Funciones b√°sicas
x**2          # x al cuadrado
2*x + 1       # funci√≥n lineal
sin(x)        # funci√≥n seno
exp(x)        # funci√≥n exponencial
log(x)        # logaritmo natural

# Funciones complejas
x**3 - 2*x**2 + x - 1    # polinomio
sin(x) * cos(x)          # producto trigonom√©trico
exp(-x**2)               # gaussiana
                        """, language="python")
                    
                    elif "Riemann" in feature_info["feature"]:
                        st.markdown("**M√©todos disponibles:**")
                        col1, col2, col3 = st.columns(3)
                        with col1:
                            st.info("**Izquierdo**\nUsa el extremo izquierdo de cada rect√°ngulo")
                        with col2:
                            st.warning("**Derecho**\nUsa el extremo derecho de cada rect√°ngulo")
                        with col3:
                            st.success("**Medio**\nUsa el punto medio (m√°s preciso)")
    
    # Syntax guide
    st.markdown("## üìù Gu√≠a de Sintaxis")
    
    col1, col2 = st.columns(2)
    
    with col1:
        st.markdown("### ‚úÖ **Sintaxis Correcta**")
        syntax_examples = [
            ("Potencias", "x**2, x**3", "No x^2"),
            ("Multiplicaci√≥n", "2*x, x*y", "Siempre usar *"),
            ("Exponencial", "exp(x)", "No e^x"),
            ("Logaritmo", "log(x)", "Logaritmo natural"),
            ("Trigonom√©tricas", "sin(x), cos(x)", "Funciones en radianes"),
            ("Constantes", "pi, e", "Constantes predefinidas")
        ]
        
        for desc, correct, note in syntax_examples:
            st.markdown(f"**{desc}:** `{correct}`")
            st.caption(note)
    
    with col2:
        st.markdown("### ‚ùå **Errores Comunes**")
        common_errors = [
            "x^2 ‚Üí Usar x**2",
            "2x ‚Üí Usar 2*x", 
            "e^x ‚Üí Usar exp(x)",
            "ln(x) ‚Üí Usar log(x)",
            "sen(x) ‚Üí Usar sin(x)",
            "‚àöx ‚Üí Usar sqrt(x)"
        ]
        
        for error in common_errors:
            st.markdown(f"‚Ä¢ {error}")

def show_faq():
    """Display frequently asked questions."""
    st.markdown("# ‚ùì Preguntas Frecuentes")
    
    for i, qa in enumerate(faq_section["questions"]):
        with st.expander(f"**{qa['q']}**", expanded=False):
            st.markdown(qa["a"])
            
            # Add visual examples for certain questions
            if "funci√≥n" in qa["q"].lower() and "sintaxis" in qa["a"].lower():
                st.markdown("**Ejemplo visual:**")
                col1, col2 = st.columns(2)
                with col1:
                    st.error("‚ùå Incorrecto")
                    st.code("x^2 + sen(x)")
                with col2:
                    st.success("‚úÖ Correcto")
                    st.code("x**2 + sin(x)")
    
    # Troubleshooting section
    st.markdown("## üîß Soluci√≥n de Problemas")
    
    troubleshooting = [
        {
            "problem": "La aplicaci√≥n no se abre",
            "solutions": [
                "Verifica que Streamlit est√© instalado: `pip show streamlit`",
                "Aseg√∫rate de estar en la carpeta correcta del proyecto",
                "Prueba con: `python -m streamlit run app.py`",
                "Revisa que no haya otro proceso usando el puerto 8501"
            ]
        },
        {
            "problem": "Error al calcular integrales",
            "solutions": [
                "Revisa la sintaxis de la funci√≥n (usar ** en lugar de ^)",
                "Verifica que los l√≠mites sean n√∫meros v√°lidos",
                "Aseg√∫rate de que la funci√≥n est√© definida en el intervalo",
                "Intenta con una funci√≥n m√°s simple primero"
            ]
        },
        {
            "problem": "Las gr√°ficas no se muestran",
            "solutions": [
                "Reinstala matplotlib: `pip install --upgrade matplotlib`",
                "Verifica que plotly est√© actualizado: `pip install --upgrade plotly`",
                "Reinicia la aplicaci√≥n completamente",
                "Comprueba la consola del navegador para errores"
            ]
        }
    ]
    
    for item in troubleshooting:
        with st.expander(f"üö® **{item['problem']}**"):
            st.markdown("**Posibles soluciones:**")
            for solution in item["solutions"]:
                st.markdown(f"‚Ä¢ {solution}")

def show_additional_resources():
    """Display additional learning resources."""
    st.markdown("# üìö Recursos Adicionales de Aprendizaje")
    st.markdown("Enlaces a recursos externos para profundizar tu conocimiento")
    
    for category in additional_learning_resources["categories"]:
        st.markdown(f"## üîó {category['category']}")
        
        for resource in category["resources"]:
            with st.expander(f"üìñ **{resource['name']}**"):
                st.markdown(f"**Descripci√≥n:** {resource['description']}")
                st.markdown(f"**Enlace:** [{resource['name']}]({resource['url']})")
                
                # Add specific recommendations
                if "Khan Academy" in resource["name"]:
                    st.success("üí° **Recomendado para principiantes** - Explicaciones claras y ejercicios interactivos")
                elif "MIT" in resource["name"]:
                    st.info("üéì **Nivel universitario** - Contenido riguroso y completo")
                elif "3Blue1Brown" in resource["name"]:
                    st.warning("üé• **Altamente visual** - Excelente para entender conceptos intuitivamente")
                
                if st.button(f"Visitar {resource['name']}", key=f"visit_{resource['name']}", help="Se abrir√° en una nueva pesta√±a"):
                    st.markdown(f"üåê **Dir√≠gete a:** {resource['url']}")
    
    # Study tips
    st.markdown("## üí° Consejos de Estudio")
    
    study_tips = [
        {
            "tip": "üìÖ Estudia Regularmente",
            "description": "Dedica al menos 30 minutos diarios a practicar integrales"
        },
        {
            "tip": "‚úçÔ∏è Practica a Mano",
            "description": "Resuelve problemas en papel antes de usar la calculadora"
        },
        {
            "tip": "üìä Visualiza Siempre",
            "description": "Usa las gr√°ficas para entender qu√© representa cada integral"
        },
        {
            "tip": "üîÑ Repite Ejemplos",
            "description": "Resuelve el mismo problema con diferentes m√©todos"
        },
        {
            "tip": "üë• Estudia en Grupo",
            "description": "Explica conceptos a otros para reforzar tu comprensi√≥n"
        },
        {
            "tip": "üéØ Enf√≥cate en Conceptos",
            "description": "Entiende el 'por qu√©' antes de memorizar f√≥rmulas"
        }
    ]
    
    cols = st.columns(2)
    for i, tip in enumerate(study_tips):
        with cols[i % 2]:
            st.info(f"**{tip['tip']}**\n\n{tip['description']}")
    
    # Final motivation
    st.markdown("---")
    st.balloons()
    st.success("""
    üåü **¬°Recuerda!** 
    
    El dominio de las matem√°ticas viene con la pr√°ctica constante. 
    Esta calculadora es tu herramienta, pero el verdadero aprendizaje 
    ocurre cuando entiendes los conceptos detr√°s de cada c√°lculo.
    
    ¬°Sigue practicando y ver√°s resultados incre√≠bles! üí™
    """)